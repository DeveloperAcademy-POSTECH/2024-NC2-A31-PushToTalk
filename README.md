# 2024-NC2-A31-PushToTalk
## ğŸ¥ Youtube Link


## ğŸ’¡ About Push To Talk

- iOSì˜ ì˜¤ë””ì˜¤ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ class. iOS ì•±ì—ì„œ ***ì›Œí‚¤í† í‚¤ í†µì‹ ì„ í†µí•´ ë¹ ë¥¸ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜ ì§„í–‰í•˜ë„ë¡ ë„ì™€ì£¼ëŠ” Framework*** (**ë¬´ì „ê¸°** ê¸°ëŠ¥)
- (watchOS 5.3, iOS 16 ì´ìƒë¶€í„° ì‚¬ìš© ê°€ëŠ¥)

**[PTT ì‚¬ìš©ë°©ë²•]**

- ì±„ë„ì— ì°¸ê°€ìë“¤ì€ **ì…ì¥**í•œë‹¤.
- ì±„ë„ì— ì°¸ê°€í•œ ì‚¬ìš©ìëŠ” í•˜ë£¨ì¢…ì¼ **ì±„ë„ ì•ˆì˜ ì‚¬ìš©ìë“¤**ê³¼ ì˜¤ë””ì˜¤ **ì†¡ìˆ˜ì‹ **ì„ í•  ìˆ˜ ìˆë‹¤.
- ë§í•˜ê³  ì‹¶ì„ ë•ŒëŠ” **ë²„íŠ¼ì„ ëˆ„ë¥´ê³  ë§í•œë‹¤**.

**[PTT ì¥ì ]**

- **ë°°í„°ë¦¬ ì ˆì•½** - ì˜¤ë””ì˜¤ ì†¡ìˆ˜ì‹ ì„ í•˜ì§€ ì•Šì„ ê²½ìš° ì•±ì€ ìê³  ìˆì–´ë„ ë˜ê¸° ë•Œë¬¸ì— ì „í™”ê¸°ëŠ¥ì— ë¹„í•´ ë°°í„°ë¦¬ ì ˆì•½ íš¨ê³¼ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤.
- **íˆ¬ëª…ì„±** - ì±„ë„ì— ì ‘ì†í•œ ëˆ„êµ°ê°€ì˜ ì˜¤ë””ì˜¤ê°€ ì¬ìƒë  ë•ŒëŠ” ë§í•˜ëŠ” ì‚¬ëŒì„ í‘œì‹œí•˜ì—¬ ì‚¬ìš©ìì—ê²Œ íˆ¬ëª…ì„±ì„ ë¶€ì—¬í•˜ëŠ” íš¨ê³¼ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤.
- **1-1 / 1-n ì»¤ë®¤ë‹ˆì¼€ì´ì…˜**ì´ ê°€ëŠ¥í•˜ë‹¤.
- LTE ë§ì„ ì´ìš©í•˜ì—¬ ê±°ë¦¬ì— ìƒê´€ì—†ì´ LTE í†µì‹ ì´ ê°€ëŠ¥í•œ ê³³ì—ì„œëŠ” ì–¸ì œ ì–´ë””ì„œë“  ë¬´ì„  í†µì‹ ì´ ê°€ëŠ¥í•˜ì—¬ ë¹„ìƒì‹œë‚˜ ì›ê±°ë¦¬ì—ì„œ í†µì‹ í•  ë•Œ íš¨ìœ¨ì ì´ë‹¤.
- ìš”ê¸ˆì œ ë‚´ í• ë‹¹ëœ í†µí™” ì‹œê°„ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³ ë„ ì¦‰ê°ì ìœ¼ë¡œ í†µì‹ í•  ìˆ˜ ìˆë‹¤. ì´ ì¸ì„¼í‹°ë¸ŒëŠ” í†µì‹ ì‚¬ë“¤ì´ ë°ì´í„° ìš”ê¸ˆì œì— PTTë¥¼ í¬í•¨í•˜ê±°ë‚˜ ì¼ë°˜ í†µí™” ì‹œê°„ì— í¬í•¨í•˜ë„ë¡ ìš”ê¸ˆ êµ¬ì¡°ë¥¼ ì¡°ì •í•¨ì— ë”°ë¼ ê°ì†Œí•  ìˆ˜ ìˆë‹¤.
- ì‚¬ìš©ìê°€ ì•±ì„ ì‚¬ìš©í•˜ì§€ ì•Šì„ ë•Œì—ëŠ” ë°°í„°ë¦¬ ìˆ˜ëª… ë³´ì¡´ì„ ìœ„í•´ ì‹œìŠ¤í…œì´ ì¼ì‹œ ì¤‘ë‹¨ ì‹œí‚¨ë‹¤. (ì‹œìŠ¤í…œì´ ì•Œì•„ì„œ í•´ì¤Œ)


## ğŸ¯ What we focus on?

- 1 : n ë˜ëŠ” n : 1 ëŒ€í™” ê°€ëŠ¥
- ë³„ë„ë¡œ ì „í™”ë²ˆí˜¸ë¥¼ ëˆ„ë¥¼ í•„ìš” ì—†ìŒ **(ë¹ ë¥¸ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜)**
- í†µí™” ì—°ê²° ëŒ€ê¸°ì‹œê°„ì´ ë¶ˆí•„ìš” **(ë¹ ë¥¸ ì»¤ë®¤ë‹ˆì¼€ì´ì…˜)**

â†’ í†µí™”ë‚˜ ì¹´í†¡ ë“± ë§ì´ ì‚¬ìš©í•˜ëŠ” ì—°ë½ ë°©ì‹ê³¼ëŠ” ë‹¤ë¥¸ ì ì— ì§‘ì¤‘

## ğŸ’¼ Use Case
ì• í”Œ ì•„ì¹´ë°ë¯¸ ì‚¬ëŒë“¤ì´ ì•½ì† ìƒëŒ€ê°€ ì–´ë””ì¸ì§€ ê¶ê¸ˆí•  ë•Œì˜ ì†Œí†µ ë„ìš°ë¯¸ ğŸ—£ï¸

## ğŸ–¼ï¸ Prototype

|  ì±„ë„ ë¦¬ìŠ¤íŠ¸ ë·° | ChannelDetailView  | ChannelDetailViewì—ì„œ ë§í•  ë•Œ  | NewChannelView  |
|---|---|---|---|
|<img width="200" alt="image" src="https://github.com/DeveloperAcademy-POSTECH/2024-NC2-A31-PushToTalk/assets/102604192/cae3e08d-be0f-4301-9a76-8e25d7c7ab71">|<img width="200" alt="image" src="https://github.com/DeveloperAcademy-POSTECH/2024-NC2-A31-PushToTalk/assets/102604192/0f836793-c079-4189-994a-8b81510d536e">|<img width="200" alt="image" src="https://github.com/DeveloperAcademy-POSTECH/2024-NC2-A31-PushToTalk/assets/102604192/0c4d46b2-dd49-4111-a0c4-4e143963ae7b">|<img width="200" alt="image" src="https://github.com/DeveloperAcademy-POSTECH/2024-NC2-A31-PushToTalk/assets/102604192/3ccda0bb-0a08-43d7-9b89-9a6447740450">|
|ì‚¬ìš©ìê°€ ë“¤ì–´ê°€ìˆëŠ” ì±„ë„ë“¤ì˜ ëª©ë¡ì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.|[?] ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ì„œ "ì–´ë””ì„¸ìš”?"ë¼ê³  ë¬¼ì–´ë³¼ ìˆ˜ ìˆë‹¤.|ë²„íŠ¼ì„ ëˆ„ë¥´ëŠ” ìˆœê°„ [!] ë²„íŠ¼ìœ¼ë¡œ ë³€ê²½ëœë‹¤.|[+]ë²„íŠ¼ì„ í†µí•´ ì±„ë„ëª…ì„ ì„¤ì •í•˜ê³  ì›í•˜ëŠ” ì‚¬ëŒì„ ì±„ë„ì— ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.|
## ğŸ› ï¸ About Code
### ChannelManager ì„¸íŒ… ë° íŠ¹ì • ì±„ë„ì— ì…ì¥í•˜ê¸° ìœ„í•œ ì½”ë“œ
```
class ChannelManagerWrapper: NSObject, ObservableObject, PTChannelManagerDelegate, PTChannelRestorationDelegate {

    func setupChannelManager() async {
        do {
            self.channelManager = try await PTChannelManager.channelManager(delegate: self, restorationDelegate: self)
            print("Channel Manager Success")
        } catch {
            print("Failed to setup channel manager: \(error.localizedDescription), \(error)")
        }
    }
    
    func joinChannel(channelUUID: UUID, description: String) {
        let channelImage = UIImage(named: "channelIcon")
        let channelDescriptor = PTChannelDescriptor(name: description, image: channelImage)
        
        channelManager?.requestJoinChannel(channelUUID: channelUUID,
                                           descriptor: channelDescriptor)
        
        print("join channel success")
    }
}
```

<br>

### PTChannelManagerDelegate - Beginning or Ending Transmission
```
func channelManager(_ channelManager: PTChannelManager,
                    channelUUID: UUID,
                    didBeginTransmittingFrom source: PTChannelTransmitRequestSource) {
    print("Did begin transmission from: \(source)")
}
    
func channelManager(_ channelManager: PTChannelManager,
                    channelUUID: UUID,
                    didEndTransmittingFrom source: PTChannelTransmitRequestSource) {
    print("Did end transmission from: \(source)")
}
    
func channelManager(_ channelManager: PTChannelManager,
                    failedToBeginTransmittingInChannel channelUUID: UUID,
                    error: Error) {
    let error = error as NSError
        
    switch error.code {
    case PTChannelError.callActive.rawValue:
        print("The system has another ongoing call that is preventing transmission.")
    default:
        break
    }
}
    
func stopTransmitting() {
    channelManager?.stopTransmitting(channelUUID: channelUUID)
    print("stop Transmitting")
}
    
func channelManager(_ channelManager: PTChannelManager,
                    failedToStopTransmittingInChannel channelUUID: UUID,
                    error: Error) {
    let error = error as NSError
        
    switch error.code {
    case PTChannelError.transmissionNotFound.rawValue:
        print("The user was not in a transmitting state")
    default:
        break
    }
}
```

<br>

### PTChannelManagerDelegate - Joining and Leaving Channel
```
func channelManager(_ channelManager: PTChannelManager, didJoinChannel channelUUID: UUID, reason: PTChannelJoinReason) {
    print("Joined channel with UUID: \(channelUUID)")
}

func channelManager(_ channelManager: PTChannelManager, didLeaveChannel channelUUID: UUID, reason: PTChannelLeaveReason) {
    print("Left channel with UUID: \(channelUUID)")
}

func channelManager(_ channelManager: PTChannelManager, failedToJoinChannel channelUUID: UUID, error: Error) {
    let error = error as NSError
    
    switch error.code {
    case PTChannelError.channelLimitReached.rawValue:
        print("The user has already joined a channel")
    default:
        break
    }
}
```

<br> 

### PTChannelManagerDelegate - Activating and deactivating the audio session

```
func channelManager(_ channelManager: PTChannelManager,
                    didActivate audioSession: AVAudioSession) {
    print("Did activate audio session")
}

func channelManager(_ channelManager: PTChannelManager,
                    didDeactivate audioSession: AVAudioSession) {
    print("Did deactivate audio session")
}
```

<br>

### ë²„íŠ¼ì„ ê¾¹ ëˆ„ë¥´ë©´ í•¨ìˆ˜ê°€ ì‹¤í–‰ë  ìˆ˜ ìˆë„ë¡ í•˜ëŠ” ì½”ë“œ - LongPressGesture

```
@GestureState private var isDetectingLongPress = false
    
    /// Long Press Gesture
    var longPress: some Gesture {
        LongPressGesture(minimumDuration: 3)
            .updating($isDetectingLongPress) { currentState, gestureState,
                transaction in
                gestureState = currentState
                transaction.animation = Animation.easeIn(duration: 0.1)
            }
    }
    
    VStack {
        Image(self.isDetectingLongPress ? .talkButtonPress : .talkButton)
                    .padding(.bottom ,25)
                    .gesture(longPress)
    }
     .onChange(of: isDetectingLongPress) {
            if isDetectingLongPress {
                channelManagerWrapper.startTransmitting()
            }
            else {
                channelManagerWrapper.stopTransmitting()
            }
    }

```
